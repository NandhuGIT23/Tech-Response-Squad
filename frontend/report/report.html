<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>status3</title>
    <!-- <link rel="stylesheet" type="text/css" href="./report.css" /> -->

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />

    <script src="https://maps.googleapis.com/maps/api/js?key=apikey&libraries=places"></script>

    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
      integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU"
      crossorigin="anonymous"
    />

    <style>
      html,
      body {
        background-image: url("https://images.pexels.com/photos/266403/pexels-photo-266403.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2");
        background-size: cover;
        /* background-repeat: no-repeat; */
        height: 100%;
        font-family: "Numans", sans-serif;
        color: white;
      }

      label {
        display: inline-block;
        margin-top: 5px;
        color: white;
        font-size: medium;
      }

      input {
        padding-top: 10px;
        padding-bottom: 5px;
        color: #f9f9f9;
      }

      .container {
        /* background-color: #f0715f; */
        /* min-width: 200px; */
        width: 100%;
        margin: 0 auto;
        position: relative;
        margin-top: 50px;
      }

      #contactus {
        font: 400 12px/16px "Roboto", Helvetica, Arial, sans-serif;
        background: #f9f9f9;
        padding: 25px;
        margin: 150px 0;
        box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2),
          0 5px 5px 0 rgba(0, 0, 0, 0.24);
        /* width: 40%; */
        margin: auto;
        width: 400px;
        background-color: rgba(0, 0, 0, 0.5) !important;
        /* min-width: 50px; */
      }

      #latitude,
      #longitude,
      #nearestPolice,
      #nearestHosp {
        display: none;
      }

      #contactus h3 {
        display: block;
        font-size: 40px;
        font-weight: 500;
        margin-bottom: 30px;
        color: #ffc312;
        text-align: center;
        font-style: normal;
      }

      #contactus h4 {
        margin: 5px 0 15px;
        display: block;
        font-size: 13px;
        font-weight: 400;
      }

      #contactus textarea {
        width: 100%;
        border: 1px solid #ccc;
        background: #fff;
        margin: 0 0 5px;
        padding: 10px;
        margin-top: 20px;
      }

      .form-select {
        margin-top: 10px;
      }

      #contactus textarea {
        height: 100px;
        max-width: 100%;
        resize: none;
      }

      #contactus button[type="submit"] {
        cursor: pointer;

        width: 100px;
        margin-left: 30%;
        border: none;
        background: #ffc312;
        color: black;

        padding: 10px;
        font-size: 15px;
      }

      #contactus input:focus,
      #contactus textarea:focus {
        outline: 0;
        border: 1px solid #aaa;
      }

      #submit {
        color: black;
        background: #ffc312;
        padding-left: 15px;
        padding-right: 15px;
        margin-left: 35%;
        font-weight: 600;
        font-size: large;
      }
    </style>
  </head>

  <body>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
    <script>
      if (!window.navigator.onLine) {
        alert("Oops check your internet and try again");
      }
    </script>
    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <!-- <script src="report.js"></script> -->

    <div class="container">
      <form id="contactus" action="" method="post">
        <h3>Report form</h3>

        <label for="picture">Take a picture of accident:</label>

        <input
          type="file"
          name="picture"
          accept="image/*"
          capture="camera"
          required
        />
        <br /><br />

        <label for="select">Type of incident:</label>

        <select class="form-select" name="type">
          <option>fire accident</option>
          <option>riots</option>
          <option>traffic</option>
          <option>vehicle accident</option>
          <option>others</option>
        </select>

        <br /><br />

        <label for="select">No.of.persons injured:</label>

        <select class="form-select" name="per_injured">
          <option>nil</option>
          <option>1-5</option>
          <option>5-10</option>
          <option>10-20</option>
          <option>more than 20</option>
        </select>

        <br /><br />
        <label for="department">Department Needed:</label>
        <br /><br />
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            id="check1"
            name="police"
            value="yes"
          />
          <label class="form-check-label">police department</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            id="check2"
            name="fire"
            value="yes"
          />
          <label class="form-check-label">fire deartment</label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            id="check3"
            name="hospital"
            value="yes"
          />
          <label class="form-check-label">hospital</label>
        </div>
        <br /><br />

        <!-- <label for="latitude"> Latitude</label> -->
        <input name="latitude" id="latitude" />
        <!-- <br> -->
        <!-- <label for="longitude"> Longitude</label> -->
        <input name="longitude" id="longitude" />
        <!-- <br><br> -->

        <input name="nearestPolice" id="nearestPolice" />
        <input name="nearestHosp" id="nearestHosp" />

        <label for="usr">Landmark:</label>
        <input type="text" name="landmark" class="form-control" id="usr" />

        <br /><br />
        <label for="text"> comment:</label>
        <textarea
          name="text"
          placeholder="Type your message here..."
          tabindex="5"
        ></textarea>
        <br /><br />

        <input type="submit" value="Submit" id="submit" />
      </form>
    </div>

    <script>
      const locations = [
        { name: "Alagapuram", lat: 11.67707, lng: 78.1423 },
        { name: "BusStand", lat: 11.668054, lng: 78.132471 },
        { name: "Shevapet", lat: 11.64978, lng: 78.14852 },
        { name: "Dalmia", lat: 11.7004, lng: 78.117 },
      ];

      const hospitals = [
        { name: "alagapuram", lat: 11.677433, lng: 78.153026 },
        { name: "threeRoads", lat: 11.6642, lng: 78.1322 },
        { name: "fiveRoads", lat: 11.6727, lng: 78.1339 },
      ];
      var map;
      var directionsService;
      var directionsRenderer;
      var sourceAutocomplete;
      var destAutocomplete;
      var latLng;
      let btnSumbit = document.querySelector("#submit");
      directionsService = new google.maps.DirectionsService();
      directionsRenderer = new google.maps.DirectionsRenderer();

      // Find the nearest Station
      let nearestStation = null;
      let nearestHosp = null;
      let shortestDistance = Number.MAX_VALUE;
      let shortestHosp = Number.MAX_VALUE;

      var x = document.getElementById("latitude");
      var y = document.getElementById("longitude");

      let nearestPolice = document.getElementById("nearestPolice");
      let nearestHospital = document.getElementById("nearestHosp");

      function getPreciseLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showExactPosition);
        } else {
          x.innerHTML = "Geolocation is not supported";
        }
      }
      function showExactPosition(position) {
        x.value = position.coords.latitude;
        y.value = +position.coords.longitude;
      }

      const successCallback = (position) => {
        latLng = {
          lat: position.coords.latitude,
          lng: position.coords.longitude,
        };
        function calcRoute() {
          locations.forEach((location) => {
            const distance =
              google.maps.geometry.spherical.computeDistanceBetween(
                new google.maps.LatLng(latLng),
                new google.maps.LatLng(location.lat, location.lng)
              );

            if (distance < shortestDistance) {
              shortestDistance = distance;
              nearestStation = location;
            }
          });
        }

        console.log(latLng);
        // console.log(nearestHosp.name);

        btnSumbit.addEventListener("click", calcRoute());
        btnSumbit.addEventListener("click", calcRoute2());
      };
      navigator.geolocation.getCurrentPosition(successCallback);
    </script>
  </body>
</html>
